<?xml version="1.0" encoding="UTF-8" ?>
<Report>
	<Title><var var="I18N::translate('Missing tags')" /></Title>
	<Description><var var="I18N::translate('A report of missing birth or death records.')" /></Description>
	<Input name="sortby" type="select" default="BIRT:DATE" options="none=>I18N::translate('none')|generation=>I18N::translate('generation')|BIRT:DATE=>I18N::translate('sort by date of birth')|NAME=>I18N::translate('sort by name')"><var var="I18N::translate('Sort order')"/></Input>
	<Input name="pageSize" type="select" options="A4=>I18N::translateContext('paper size','A4')|A3=>I18N::translateContext('paper size', 'A3')|US-Letter=>I18N::translateContext('paper size','Letter')|US-Tabloid=>I18N::translateContext('paper size','Tabloid')"><var var="I18N::translate('Page size')" /></Input>
	<Input name="b_year_lim" type="text" default="1934" ><var var="I18N::translate('Do not report missing death records for individuals born after')"/></Input>
	<!--
	<Input name="pid" type="text" default="" lookup="INDI"><var var="I18N::translate('Individual')"/></Input>
	<Input name="relatives" type="select" default="direct-ancestors" options="child-family=>I18N::translate('Parents and siblings')|spouse-family=>I18N::translate('Spouses and children')|direct-ancestors=>I18N::translate('Direct line ancestors')|ancestors=>I18N::translate('Direct line ancestors and their families')|descendants=>I18N::translate('Descendants')|all=>I18N::translate('All')"><var var="I18N::translate('Choose relatives')"/></Input>
	<Input name="maxgen" type="select" default="-1" options="1=>I18N::number(1)|2=>I18N::number(2)|3=>I18N::number(3)|4=>I18N::number(4)|5=>I18N::number(5)|6=>I18N::number(6)|7=>I18N::number(7)|8=>I18N::number(8)|9=>I18N::number(9)|10=>I18N::number(10)|-1=>I18N::translate('All')"><var var="I18N::translate('Generations')"/></Input>
	<Input name="fonts" type="select" default="dejavusans" options="arialunicid0=>I18N::translateContext('font name', 'Arial')|dejavusans=>I18N::translateContext('font name', 'DejaVu')|helvetica=>I18N::translateContext('font name', 'Helvetica')"><var var="I18N::translate('Font')"/></Input>
	-->
	<SetVar name="fonts" value="dejavusans" />
	<SetVar name="format" value="@format" />
	<if condition="$format=='HTML'">
		<SetVar name="pageSize" value="A3" comment="use more window width"/>
	</if>
	<Input name="fbirt" type="checkbox" default="1"><var var="I18N::translate('Birth')"/></Input>
	<Input name="fmarr" type="checkbox" default="0"><var var="I18N::translate('Marriage')"/></Input>
	<Input name="fdeat" type="checkbox" default="1"><var var="I18N::translate('Death')"/></Input>
	<SetVar name="fenga" value="off"/>
	<SetVar name="fsour" value="off"/>
	<!-- Header -->
	<Style name="header" font="$fonts" size="18" style="b"/>
	<!-- Generated by style - required style name by the generator -->
	<Style name="genby" font="$fonts" size="8"/>
	<!-- Page numbers text -->
	<Style name="pagenum" font="$fonts" size="8"/>
	<!-- Date Text - CSS Style name -->
	<Style name="date" font="$fonts" size="8"/>
	<!-- Column list labels - CSS Style name -->
	<Style name="list_label" font="$fonts" size="9" style="b"/>
	<!-- List values - CSS Style name -->
	<Style name="list_value" font="$fonts" size="9"/>
	<SetVar name="name" value="300" />
	<SetVar name="printname" value="0" />
	<SetVar name="vspace" value="5" />
	<SetVar name="nrrelatives" value="0" />
	<SetVar name="nrprinted" value="0" />
	<SetVar name="nrevent" value="0" />
	<SetVar name="nrmissingevent" value="0" />
	<SetVar name="dump" value="dval" />
	<SetVar name="dval" value="25" />
	<SetVar name="urlbase" value="@base_url"/>
	<SetVar name="lang" value="@lang"/>
	<SetVar name="lc1" value="1"/>
	<if condition="$lang=='de'">
		<SetVar name="lc1" value="0"/>
	</if>
	<Doc pageSize="$pageSize">
		<Header>
			<Cell align="center" newline="1" style="header"><var var="I18N::translate('Missing data')" /></Cell>
			<Cell align="rightrtl" newline="1" style="pagenum"><var var="I18N::translate('Page')"/> <PageNum/> / <TotalPages/></Cell>
			<Cell align="center" border="1" style="list_label" width="$name"><var var="I18N::translate('Name')" /></Cell>
			<Cell align="center" border="1" newline="1" style="list_label"><var var="I18N::translate('Missing data')" /></Cell>
		</Header>
<!--
Start with BIRT GEDCOM tag.
End it with DEAT and BURI
-->
		<Body>
			<SetVar name="urlbase" value="@base_url"/>
			<SetVar name="urlbase" value="$urlbase"/>
			<List list="individual" sortby="$sortby">
				<SetVar name="no_fact" value=""/>
				<SetVar name="no_data" value=""/>
				<SetVar name="no_source" value=""/>
				<SetVar name="birth_date" value="0"/>
				<Gedcom id="BIRT"><SetVar name="birth_date" value="@DATE" truncate="Y"/></Gedcom>
				<!-- Relatives counter -->
				<SetVar name="tree" value="@tree"/>
				<SetVar name="nrrelatives" value="$nrrelatives + 1" />
				<SetVar name="printname" value="0" />
				<SetVar name="id" value="@ID"/>
				<!-- Birth -->
				<if condition="$fbirt=='on'">
					<SetVar name="evnt" value="I18N::translate('Birth')" lcfirst="$lc1"/>
					<SetVar name="fact" value="BIRT"/>
					<SetVar name="str_date" value="I18N::translate('Date of birth')" lcfirst="$lc1"/>
					<SetVar name="str_plac" value="I18N::translate('Place of birth')" lcfirst="$lc1"/>
					<!-- Total Event Counter -->
					<setvar name="ffound" value="N"/>
					<Gedcom id="$fact" >
						<setvar name="ffound" value="Y"/>
						<setvar name="fdate" value="@DATE" />
						<setvar name="fplac" value="@PLAC" />
						<setvar name="fsrc" value="@SOUR" />
					</Gedcom>
					<if condition="$fact=='MARR' and $ffound=='N'">
					<Gedcom id="EVEN" > <!-- partnership without marriage recorded as Event:Type -->
						<setvar name="ffound" value="Y"/>
						<setvar name="fdate" value="@DATE" />
						<setvar name="fplac" value="@PLAC" />
						<setvar name="fsrc" value="@SOUR" />
					</Gedcom>
					</if>
					<if condition="$ffound=='N'">
						<SetVar name="nrevent" value="$nrevent + 1" />
						<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
						<SetVar name="no_fact1" value="$no_fact $evnt ($fact),"/>
						<SetVar name="no_fact" value="$no_fact1"/>
					</if>
					<if condition="$ffound=='Y'">
					<SetVar name="nrevent" value="$nrevent + 2" />
					<if condition="$fdate==''">
						<!-- Missing event counter -->
						<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
						<SetVar name="no_data1" value="$no_data $str_date, "/>
						<SetVar name="no_data" value="$no_data1"/>
					</if>
					<if condition="$fplac==''">
						<!-- Missing event counter -->
						<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
						<SetVar name="no_data1" value="$no_data $str_plac, "/>
						<SetVar name="no_data" value="$no_data1"/>
					</if>
					<if condition="$fsour=='on' and (($fdate!='') or ($fplac!=''))">
						<!-- Total Event Counter -->
						<SetVar name="nrevent" value="$nrevent + 1" />
						<if condition="$fsrc==''">
							<!-- Missing event counter -->
							<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
							<SetVar name="no_source1" value="$no_source $fact, "/>
							<SetVar name="no_source" value="$no_source1"/>
						</if>
					</if>
					</if>
				</if>
				<!-- ENGA -->
				<if condition="$fenga=='on'">
					<SetVar name="evnt" value="I18N::translate('engagement')" lcfirst="$lc1"/>
					<SetVar name="fact" value="ENGA"/>
					<SetVar name="str_date" value="I18N::translate('Date of engagement')"/>
					<SetVar name="str_plac" value="I18N::translate('Place of engagement')"/>
					<Gedcom id="@FAMS">
					<!-- Total Event Counter -->
					<setvar name="ffound" value="N"/>
					<Gedcom id="$fact" >
						<setvar name="ffound" value="Y"/>
						<setvar name="fdate" value="@DATE" />
						<setvar name="fplac" value="@PLAC" />
						<setvar name="fsrc" value="@SOUR" />
					</Gedcom>
					<if condition="$fact=='MARR' and $ffound=='N'">
					<Gedcom id="EVEN" > <!-- partnership without marriage recorded as Event:Type -->
						<setvar name="ffound" value="Y"/>
						<setvar name="fdate" value="@DATE" />
						<setvar name="fplac" value="@PLAC" />
						<setvar name="fsrc" value="@SOUR" />
					</Gedcom>
					</if>
					<if condition="$ffound=='N'">
						<SetVar name="nrevent" value="$nrevent + 1" />
						<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
						<SetVar name="no_fact1" value="$no_fact $evnt ($fact),"/>
						<SetVar name="no_fact" value="$no_fact1"/>
					</if>
					<if condition="$ffound=='Y'">
					<SetVar name="nrevent" value="$nrevent + 2" />
					<if condition="$fdate==''">
						<!-- Missing event counter -->
						<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
						<SetVar name="no_data1" value="$no_data $str_date, "/>
						<SetVar name="no_data" value="$no_data1"/>
					</if>
					<if condition="$fplac==''">
						<!-- Missing event counter -->
						<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
						<SetVar name="no_data1" value="$no_data $str_plac, "/>
						<SetVar name="no_data" value="$no_data1"/>
					</if>
					<if condition="$fsour=='on' and (($fdate!='') or ($fplac!=''))">
						<!-- Total Event Counter -->
						<SetVar name="nrevent" value="$nrevent + 1" />
						<if condition="$fsrc==''">
							<!-- Missing event counter -->
							<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
							<SetVar name="no_source1" value="$no_source $fact, "/>
							<SetVar name="no_source" value="$no_source1"/>
						</if>
					</if>
					</if>
					</Gedcom>
				</if>
				<!-- MARR -->
				<if condition="$fmarr=='on'">
					<SetVar name="evnt" value="I18N::translate('marriage')" lcfirst="$lc1"/>
					<SetVar name="fact" value="MARR"/>
					<SetVar name="str_date" value="I18N::translate('Date of marriage')" lcfirst="$lc1"/>
					<SetVar name="str_plac" value="I18N::translate('Place of marriage')" lcfirst="$lc1"/>
					<Gedcom id="@FAMS">
					<!-- Total Event Counter -->
					<setvar name="ffound" value="N"/>
					<Gedcom id="$fact" >
						<setvar name="ffound" value="Y"/>
						<setvar name="fdate" value="@DATE" />
						<setvar name="fplac" value="@PLAC" />
						<setvar name="fsrc" value="@SOUR" />
					</Gedcom>
					<if condition="$fact=='MARR' and $ffound=='N'">
					<Gedcom id="EVEN" > <!-- partnership without marriage recorded as Event:Type -->
						<setvar name="ffound" value="Y"/>
						<setvar name="fdate" value="@DATE" />
						<setvar name="fplac" value="@PLAC" />
						<setvar name="fsrc" value="@SOUR" />
					</Gedcom>
					</if>
					<if condition="$ffound=='N'">
						<SetVar name="nrevent" value="$nrevent + 1" />
						<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
						<SetVar name="no_fact1" value="$no_fact $evnt ($fact),"/>
						<SetVar name="no_fact" value="$no_fact1"/>
					</if>
					<if condition="$ffound=='Y'">
					<SetVar name="nrevent" value="$nrevent + 2" />
					<if condition="$fdate==''">
						<!-- Missing event counter -->
						<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
						<SetVar name="no_data1" value="$no_data $str_date, "/>
						<SetVar name="no_data" value="$no_data1"/>
					</if>
					<if condition="$fplac==''">
						<!-- Missing event counter -->
						<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
						<SetVar name="no_data1" value="$no_data $str_plac, "/>
						<SetVar name="no_data" value="$no_data1"/>
					</if>
					<if condition="$fsour=='on' and (($fdate!='') or ($fplac!=''))">
						<!-- Total Event Counter -->
						<SetVar name="nrevent" value="$nrevent + 1" />
						<if condition="$fsrc==''">
							<!-- Missing event counter -->
							<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
							<SetVar name="no_source1" value="$no_source $fact, "/>
							<SetVar name="no_source" value="$no_source1"/>
						</if>
					</if>
					</if>
					</Gedcom>
				</if>
				<!-- DEAT -->
				<if condition="$fdeat=='on' and ($birth_date LT $b_year_lim)" >
					<SetVar name="evnt" value="I18N::translate('Death')" lcfirst="$lc1"/>
					<SetVar name="fact" value="DEAT"/>
					<SetVar name="str_date" value="I18N::translate('Date of death')" lcfirst="$lc1"/>
					<SetVar name="str_plac" value="I18N::translate('Place of death')" lcfirst="$lc1"/>
					<!-- Total Event Counter -->
					<setvar name="ffound" value="N"/>
					<Gedcom id="$fact" >
						<setvar name="ffound" value="Y"/>
						<setvar name="fdate" value="@DATE" />
						<setvar name="fplac" value="@PLAC" />
						<setvar name="fsrc" value="@SOUR" />
					</Gedcom>
					<if condition="$fact=='MARR' and $ffound=='N'">
					<Gedcom id="EVEN" > <!-- partnership without marriage recorded as Event:Type -->
						<setvar name="ffound" value="Y"/>
						<setvar name="fdate" value="@DATE" />
						<setvar name="fplac" value="@PLAC" />
						<setvar name="fsrc" value="@SOUR" />
					</Gedcom>
					</if>
					<if condition="$ffound=='N'">
						<SetVar name="nrevent" value="$nrevent + 1" />
						<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
						<SetVar name="no_fact1" value="$no_fact $evnt ($fact),"/>
						<SetVar name="no_fact" value="$no_fact1"/>
					</if>
					<if condition="$ffound=='Y'">
					<SetVar name="nrevent" value="$nrevent + 2" />
					<if condition="$fdate==''">
						<!-- Missing event counter -->
						<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
						<SetVar name="no_data1" value="$no_data $str_date, "/>
						<SetVar name="no_data" value="$no_data1"/>
					</if>
					<if condition="$fplac==''">
						<!-- Missing event counter -->
						<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
						<SetVar name="no_data1" value="$no_data $str_plac, "/>
						<SetVar name="no_data" value="$no_data1"/>
					</if>
					<if condition="$fsour=='on' and (($fdate!='') or ($fplac!=''))">
						<!-- Total Event Counter -->
						<SetVar name="nrevent" value="$nrevent + 1" />
						<if condition="$fsrc==''">
							<!-- Missing event counter -->
							<SetVar name="nrmissingevent" value="$nrmissingevent + 1" />
							<SetVar name="no_source1" value="$no_source $fact, "/>
							<SetVar name="no_source" value="$no_source1"/>
						</if>
					</if>
					</if>
					</if>
				<!-- print result -->
				<if condition="$no_fact!='' and $printname=='1'">
					<Cell style="list_value" width="$name"> </Cell>
				</if>
				<if condition="$no_fact!='' and $printname=='0'">
					<SetVar name="url" value="$urlbase/individual/$id" />
					<Cell style="list_value" width="$name" url="$url"><GetPersonName id="" /></Cell>
					<SetVar name="printname" value="1" />
				</if>
				<if condition="$no_fact!=''">
					<SetVar name="newtext" value="I18N::translate('Missing records')"/>
					<SetVar name="newtext" value="$newtext: $no_fact"/>
					<Cell newline="1" style="list_value"><var var="newtext" /></Cell>
				</if>
				<if condition="$printname=='1'">
					<SetVar name="nrprinted" value="$nrprinted + 1" />
					<TextBox height="1" newline="1" padding="0"/>
					<Line />
					<TextBox height="1" newline="1" padding="0"/>
				</if>
			</List>
			<TextBox height="$vspace" newline="1" padding="0"/>
			<Cell align="rightrtl" newline="1" style="list_label"><var var="I18N::translate('Total individuals')"/>: <var var="nrprinted"/> / <var var="nrrelatives"/></Cell>
			<Cell align="rightrtl" newline="1" style="list_label"><var var="I18N::translate('Total events')"/>: <var var="nrmissingevent"/> / <var var="nrevent"/></Cell>
			<TextBox height="$vspace" newline="1" padding="0"/>
		</Body>
		<Footer>
			<Cell align="rightrtl" newline="1" style="date"><Now/></Cell>
		</Footer>
	</Doc>
</Report>
